> **必読**: 本ファイルを読む前に、必ず .agents/rules/AGENTS.md を先に読むこと。共通フレームワーク・ルール・テンプレートの定義は全てそちらに記載されている。

# Codex Settings

## 原則

**設計判断・意図解釈が必要なタスクは Claude に委任する。自分では設計判断しない。**
**情報収集・大規模分析を伴うタスクは Gemini に委任する。自分では検索しない。**

以下の場合**のみ**、自分で実行する:

- コードの実装・編集・リファクタリング
- テスト作成・実行・lint
- 定型的なPR作成・ルーティン修正
- ボイラープレート・定型コード生成
- 依存パッケージの変更・更新（package.json等）
- CI/CDパイプライン自動化・Automations
- マルチエージェント並列作業（worktree）
- `codex review` によるコードレビュー

## ワークフロー

> 標準ワークフローは .agents/rules/AGENTS.md の「標準委任ワークフロー」に従う。以下は本エージェント固有のカスタマイズ値:

| テンプレート変数 | Codex CLI の値 |
|---|---|
| 自己実行の開始前 | 実行前に |
| 判定カテゴリ | 実装 / 設計判断 / 調査 / 分析 |
| 委任先1の分岐条件 | 設計判断・意図解釈・Git複雑操作・MCP |
| 委任先1 | Claude |
| 委任先2の分岐条件 | 最新情報調査・大規模分析・マルチモーダル |
| 委任先2 | Gemini |
| 自己実行の条件 | コード実装・テスト・修正 |
| 委任コマンド | claude -p "指示" または gemini -p "指示" |

## Claude への委任手順

`claude -p "指示"` で Claude Code に委任する。

> **フォールバック**: Claude Codeが未インストールの場合、自分で対応する（設計判断は慎重に行うこと）。

### 指示に含める内容

- 判断が必要な背景・コンテキスト
- 選択肢がある場合はその一覧
- 期待する出力（方針決定、設計案、タスク分解等）

### 委任対象

| ID | 委任タスク | 理由 |
|---|---|---|
| X→C1 | 設計・アーキテクチャの判断が必要な場面 | Claudeの推論力と構造理解が圧倒的 |
| X→C2 | ユーザー意図の解釈が曖昧なタスク | Claudeは日本語ニュアンスの理解が深い |
| X→C3 | 複雑なGit操作（マージコンフリクト解消、rebase判断） | Claudeはコンテキストを保持した上でGit判断ができる |
| X→C4 | MCP連携が必要な外部ツール統合 | Figma/Slack/DB等のMCPサーバー接続はClaude Codeの機能 |
| X→C5 | タスク全体の分解・計画・優先順位決定 | 「指揮者」としてのタスク整理はClaudeの役割 |
| X→C6 | エラーの根本原因分析（修正ではなく分析） | Claudeの深い推論で原因特定 → Codexが修正実装 |
| X→C7 | コードの意図・設計意図の説明 | 「なぜこう書かれているか」の説明力はClaudeが上 |

## Gemini への委任手順

`gemini -p "指示"` で Gemini CLI に委任する。

> **フォールバック**: Gemini CLIが未インストールの場合、`claude -p "指示"` でClaude Code（`opus` モデル推奨）に委任して代替する。

### 指示に含める内容

> 指示に含める内容は `.agents/rules/AGENTS.md` の委任指示テンプレートを参照

### 委任対象

| ID | 委任タスク | 理由 |
|---|---|---|
| X→G1 | 最新技術・ライブラリの情報調査 | Google Search グラウンディング |
| X→G2 | 大量ログ・仕様書の横断分析 | 100万トークンコンテキスト |
| X→G3 | 画像・PDF・動画などマルチモーダル入力の解析 | Geminiのマルチモーダルが最強 |
| X→G4 | GCP・Firebase関連の設定・構成提案 | Googleエコシステムとの親和性 |
| X→G5 | 構造化出力（JSON Schema）を前提とした生成タスク | Geminiの構造化出力が安定 |

## タスク完了前チェックリスト

> 共通チェックリストは .agents/rules/AGENTS.md の「共通完了チェックリスト」を参照。以下は本エージェント固有のチェック項目:

- 設計判断を自分でしていないか？ → した場合、Claude に委任すべきだった
- Web検索や大規模分析を自分でやっていないか？ → やった場合、Gemini に委任すべきだった

## 並列委任の例

- 「設計を相談しつつ、最新情報も調べたい」→ Claude(設計判断) と Gemini(調査) を同時に呼ぶ
- 「原因を分析して、その結果をもとに調査」→ Claude(分析) の完了後に Gemini(調査)（依存あり → 直列）
